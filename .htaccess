# Enable URL Rewriting
RewriteEngine On

# Set base directory (adjust if your site is in a subdirectory)
RewriteBase /restartlabs/

# Redirect index.html or index to root
RewriteCond %{THE_REQUEST} /restartlabs/index\.(html|php)?[\s?] [NC]
RewriteRule ^index\.(html|php)?$ /restartlabs/ [NC,R=301,L]

# Redirect /index to root (for subdirectory)
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s/restartlabs/index[\s?] [NC]
RewriteRule ^index/?$ /restartlabs/ [NC,R=301,L]

# Remove .html extension from URLs
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^([^\.]+)$ $1.html [NC,L]

# Redirect .html to clean URL
RewriteCond %{THE_REQUEST} /restartlabs/([^.]+)\.html [NC]
RewriteRule ^ /restartlabs/%1? [NC,L,R=301]

# Default page
DirectoryIndex index.html index.php

# Security headers
<IfModule mod_headers.c>
    Header set X-Content-Type-Options "nosniff"
    Header set X-Frame-Options "SAMEORIGIN"
    Header set X-XSS-Protection "1; mode=block"
    Header set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>

# Prevent access to sensitive files
<FilesMatch "\.(sql|log|md|env)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Protect config directory
<IfModule mod_rewrite.c>
    RewriteRule ^config/ - [F,L]
</IfModule>
